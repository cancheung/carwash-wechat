<template>
  <div class="person-index">

    <p class="person-index__text person-index__text__name">
      欢迎您回来，<b>{{uname}}</b>
    </p>

    <countup
      :start-val="0"
      :duration="1"
      :decimals="2"
      :end-val="balance"
      class="person-index__text person-index__text__price"
    />

    <p class="person-index__text person-index__text__tips">余额 ( 元 )</p>

    <div class="person-index__text person-index__text__transfer">
      <x-button mini link="/transfer" class="car-btn__yellow">
        <svg class="svg-icon" width="16px" height="16px" viewBox="0 0 1024 1024">
          <path d="M912.29184 281.21088C852.88448 218.42944 773.91872 183.808 689.62816 183.808L395.78624 183.808l0-45.37344c0-27.03872-17.00352-39.32672-32.87552-39.32672-7.8848 0-15.87712 2.6624-23.76192 8.0896L195.75808 205.11232c-12.49792 8.6016-19.66592 21.09952-19.56352 34.41152 0.1024 13.31712 7.4752 25.70752 20.17792 34.00192L339.1488 366.93504c7.68 5.0176 15.56992 7.5776 23.24992 7.5776 16.08192 0 33.38752-12.4928 33.38752-39.63904l0-45.06624 293.84192 0c117.06368 0 212.21376 101.08928 212.21376 225.42848 0 20.58752-2.56 40.97024-7.7824 60.73344-7.3728 27.96032 8.4992 57.14944 35.33312 64.93184 4.5056 1.3312 9.216 2.048 13.93152 2.048 22.94272 0 43.22304-16.08192 49.26464-39.01952 7.5776-28.88192 11.4688-58.78784 11.4688-88.59136C1004.0576 426.84928 971.38688 343.78752 912.29184 281.21088z" fill='#fff'></path>
          <path d="M711.13728 663.43936c-7.7824-5.0176-15.56992-7.5776-23.24992-7.5776-16.08192 0-33.38752 12.4928-33.38752 39.63904l0 45.06624L335.7696 740.56704c-117.06368 0-212.21376-101.08928-212.21376-225.42848 0-43.73504 11.776-86.13376 34.10432-122.5984 14.75072-24.27392 8.0896-56.84224-15.05792-72.61696-23.04512-15.87712-56.43264-8.2944-71.28576 15.87712C38.65088 389.26336 21.34016 451.2256 21.34016 515.13856c0 88.28416 32.67072 171.45344 91.77088 233.92768 59.29984 62.78144 138.368 97.40288 222.66368 97.40288l318.73024 0 0 45.37344c0 27.03872 17.00352 39.33184 32.87552 39.33184 7.8848 0 15.87712-2.6624 23.65952-8.0896l143.3856-97.91488c12.5952-8.6016 19.66592-21.09952 19.56352-34.41152-0.1024-13.312-7.4752-25.70752-20.17792-34.00192L711.13728 663.43936z" fill='#fff'></path>
        </svg>
        余额转让
      </x-button>
    </div>


    <div class="person-index__btns">

      <flexbox :gutter="26" class="person-index__btns__margin">
        <flexbox-item>
          <x-button class="car-btn car-btn__blue car-btn--radius" @click.native="goTo()">
            <svg class="svg-icon" width="22px" height="22px" viewBox="0 0 1024 1024">
              <path d="M750.549734 314.559532C736.088033 306.222511 720.79769 299.275468 705.87324 291.673312 708.820537 288.356448 711.380237 286.026526 713.900925 283.655304 739.803255 259.277993 763.057644 231.076816 775.21125 197.807065 781.102947 181.678476 782.557801 174.660227 786.647557 159.685206 794.258749 112.406014 785.510867 83.659387 756.982302 59.764864 718.428879 27.470663 674.686596 23.646797 628.478598 42.605188 625.272454 43.919687 623.145131 44.879569 619.950551 41.901655 560.476831-13.502361 464.996402-14.019329 405.111983 40.683999 402.313666 43.240363 400.29771 43.885505 396.666356 42.239178 372.364939 31.226165 346.967317 28.867761 320.895778 34.175598 271.49175 44.234424 230.623012 85.63754 237.874105 142.18088 244.166386 191.240273 263.468411 233.692994 296.746212 270.288156 303.576466 277.799166 310.836227 284.932772 318.185674 292.534925 316.353364 293.409359 314.53986 294.323668 312.693113 295.156802 142.710391 371.728076 27.888898 538.101049 14.443878 727.344574 10.725784 779.675257 9.054941 826.606699 27.173047 882.807074 52.778017 962.230769 120.36274 1024.196044 207.02733 1023.999511 411.255334 1023.535237 615.487659 1024.04651 819.715664 1023.736043 885.324016 1023.636351 935.834363 994.62768 972.478852 941.807086 991.105512 914.956014 997.845854 884.068627 1004.888951 852.522358 1007.758699 839.668616 1011.097663 864.816794 1011.097713 810.301687 1011.097763 755.786581 1009.960848 688.851359 994.490981 631.97584 956.902164 493.789801 876.401155 387.110404 750.549734 314.559532ZM958.776084 814.643739C954.296209 843.825306 949.452089 874.426667 933.002803 898.957462 900.642432 947.214885 838.645301 973.716828 780.706309 973.808246 600.350891 974.091063 419.992526 973.623986 239.638582 974.04821 163.104724 974.226755 90.919494 931.642815 72.367412 857.796175 60.58819 810.912843 61.860797 752.261184 65.14474 704.45227 77.019793 531.559717 233.449626 368.518621 383.560755 298.564285 385.193136 297.802963 340.295632 258.442846 334.262974 251.580965 304.873949 218.148577 286.522396 191.075284 280.966073 146.255946 274.14451 91.229487 315.293574 74.993225 340.196829 69.746829 363.221419 64.896091 412.097437 89.455454 414.568898 87.120072 467.452927 37.142895 551.771259 37.615686 604.293991 88.232771 607.114936 90.953813 608.993601 90.076795 611.824836 88.875538 652.631784 71.556571 687.140684 60.87809 721.188009 90.382466 746.381755 112.213647 746.97013 128.431341 740.79149 162.709323 737.035658 176.93587 713.735312 214.970461 704.838975 226.755929 671.961008 270.308304 639.78056 298.101494 637.562726 300.275471 637.323835 300.509722 707.835374 333.607871 719.624911 342.589452 828.473436 425.513373 901.856046 489.651395 935.051028 615.897724 952.491271 682.224004 969.19421 746.770536 958.776084 814.643739L958.776084 814.643739ZM446.384203 459.682928C437.998792 450.832904 412.533586 424.647868 412.533586 424.647868L362.582368 424.647868C362.582368 424.647868 362.750079 441.722563 362.750079 446.807927 362.750079 451.893293 487.278341 574.509144 487.278341 574.509144L362.582368 574.509144 362.582368 624.39024 487.278341 624.39024 487.278341 674.64024 362.750079 674.64024 362.750079 724.225605 487.460413 724.225605 487.460413 824.195114 537.411632 824.195114 536.964344 724.225605 662.289678 724.225605 662.289678 674.341459 537.411632 674.341459 536.964319 624.39024 662.121941 624.39024 662.121941 574.509144 536.964319 574.509144 662.121941 446.807927 662.121941 424.647868 612.33846 424.647868C612.33846 424.647868 568.963468 466.60366 559.475659 477.045732 555.520423 480.384397 526.689353 511.182622 512.433125 525.344312L446.384203 459.682928Z"
                fill='#fff' />
            </svg>
            余额充值
          </x-button>
        </flexbox-item>
        <flexbox-item>
          <x-button class="car-btn car-btn__yellow car-btn--radius" @click.native="scanQRCode()">
            <svg class="svg-icon" width="22px" height="22px" viewBox="0 0 1024 1024">
              <path d="M987.386104 549.682227H37.139875c-20.178575 0-36.557614-16.363689-36.557614-36.540217 0-20.159132 16.379039-36.558637 36.557614-36.558638h950.246229c20.215414 0 36.540218 16.399505 36.540218 36.558638 0.001023 20.176528-16.32378 36.540218-36.540218 36.540217zM877.768521 988.265124H676.274414c-20.215414 0-36.577057-16.32685-36.577057-36.539194 0-20.215414 16.360619-36.577057 36.577057-36.577057h201.49513c20.179598 0 36.502355-16.361643 36.502356-36.539194V695.876867c0-20.215414 16.361643-36.539194 36.577056-36.539194 20.217461 0 36.539194 16.322757 36.539195 36.539194v182.733835c-0.002047 60.462047-49.192376 109.654422-109.61963 109.654422z m-522.788717 0h-208.201879c-60.464093 0-109.636003-49.192376-109.636003-109.654422V695.876867c0-20.215414 16.379039-36.539194 36.55659-36.539194 20.179598 0 36.522822 16.322757 36.522822 36.539194v182.733835c0 20.179598 16.413831 36.539194 36.557614 36.539194h208.201879c20.215414 0 36.57808 16.361643 36.57808 36.577057-0.002047 20.212344-16.364713 36.538171-36.579103 36.538171zM73.698512 366.946346c-20.177552 0-36.556591-16.379039-36.55659-36.558637V147.654898c0-60.462047 49.173956-109.637026 109.636003-109.637026h208.201879c20.215414 0 36.57808 16.379039 36.57808 36.557614 0 20.142759-16.362666 36.521798-36.57808 36.521798h-208.201879c-20.142759 0-36.557614 16.415878-36.557614 36.557614V330.387709c0 20.179598-16.344247 36.558637-36.521799 36.558637z m877.149421 0c-20.215414 0-36.577057-16.379039-36.577057-36.558637V147.654898c0-20.141736-16.322757-36.557614-36.502355-36.557614H676.274414c-20.215414 0-36.577057-16.379039-36.577057-36.521798 0-20.177552 16.360619-36.557614 36.577057-36.557614h201.49513c60.426231 0 109.618607 49.173956 109.618607 109.637026V330.387709c-0.002047 20.179598-16.322757 36.558637-36.540218 36.558637z"
                fill='#fff' />
            </svg>
            扫码洗车
          </x-button>
        </flexbox-item>
      </flexbox>

      <flexbox :gutter="26" class="person-index__btns__margin">
        <flexbox-item>
          <x-button class="car-btn car-btn__yellow car-btn--radius" @click.native="openDialog()">
            <svg class="svg-icon" width="22px" height="22px" viewBox="0 0 1024 1024">
              <path d="M693.248 347.21792c11.63264 0 23.26528 0.86016 34.93888 2.048C696.85248 203.12064 540.672 94.74048 362.496 94.74048 163.34848 94.74048 0 230.4 0 403.00544c0 99.57376 54.19008 181.4528 144.91648 244.89984l-36.12672 109.1584 126.85312-63.81568c45.34272 8.84736 81.87904 18.0224 126.85312 18.0224 11.22304 0 22.48704-0.36864 33.71008-1.59744-7.24992-24.08448-11.22304-49.7664-11.22304-75.85792C384.94208 475.66848 521.05216 347.21792 693.248 347.21792L693.248 347.21792zM498.15552 248.87296c27.27936 0 45.34272 18.06336 45.34272 45.34272s-18.06336 45.34272-45.34272 45.34272c-27.32032 0-54.59968-18.06336-54.59968-45.34272C443.96544 266.97728 471.2448 248.87296 498.15552 248.87296L498.15552 248.87296zM244.49024 339.59936c-27.32032 0-54.59968-18.06336-54.59968-45.34272s27.27936-45.34272 54.59968-45.34272c27.27936 0 45.30176 18.06336 45.30176 45.34272C289.792 321.1264 271.7696 339.59936 244.49024 339.59936L244.49024 339.59936zM1024 629.80096c0-144.87552-144.91648-262.92224-307.89632-262.92224-172.60544 0-308.26496 118.04672-308.26496 262.92224 0 145.32608 135.70048 262.9632 308.26496 262.9632 36.12672 0 72.62208-9.25696 108.7488-18.06336l99.57376 54.59968-27.27936-90.7264C969.80992 783.9744 1024 711.2704 1024 629.80096L1024 629.80096zM616.16128 584.45824c-18.0224 0-36.12672-18.0224-36.12672-36.12672 0-18.0224 18.06336-36.12672 36.12672-36.12672 27.32032 0 45.34272 18.06336 45.34272 36.12672C661.504 566.39488 643.4816 584.45824 616.16128 584.45824L616.16128 584.45824zM815.67744 584.45824c-18.06336 0-36.12672-18.0224-36.12672-36.12672 0-18.0224 18.0224-36.12672 36.12672-36.12672 27.27936 0 45.34272 18.06336 45.34272 36.12672C861.02016 566.39488 842.5472 584.45824 815.67744 584.45824L815.67744 584.45824zM815.67744 584.45824" fill="#ffffff" ></path>
            </svg>
            关注公众号
          </x-button>
        </flexbox-item>
        <flexbox-item>
          <x-button class="car-btn car-btn__blue car-btn--radius" link="/spread">
            <svg class="svg-icon" width="22px" height="22px" viewBox="0 0 1024 1024">
              <path d="M747.2 896H276.8c-46.4 0-84.8-32-94.4-76.8L64 230.4c-3.2-12.8 3.2-27.2 16-33.6 11.2-6.4 27.2-4.8 36.8 3.2l198.4 169.6 171.2-228.8c12.8-16 38.4-16 51.2 0l171.2 228.8L907.2 200c9.6-9.6 25.6-9.6 36.8-3.2 11.2 6.4 17.6 20.8 16 33.6L841.6 819.2c-9.6 44.8-48 76.8-94.4 76.8zM145.6 308.8l99.2 497.6c3.2 14.4 16 25.6 32 25.6h470.4c16 0 28.8-11.2 32-25.6l99.2-497.6L724.8 440c-6.4 6.4-16 8-24 8-8-1.6-17.6-4.8-22.4-12.8L512 212.8 345.6 435.2c-4.8 6.4-12.8 11.2-22.4 12.8-8 1.6-17.6-1.6-24-8L145.6 308.8z" fill="#ffffff" />
              <path d="M512 736c-11.2 0-22.4-6.4-27.2-16l-96-160c-9.6-14.4-4.8-35.2 11.2-43.2 14.4-9.6 35.2-4.8 43.2 11.2L512 641.6 580.8 528c9.6-14.4 28.8-20.8 43.2-11.2 14.4 9.6 20.8 28.8 11.2 43.2l-96 160c-4.8 9.6-16 16-27.2 16z" fill="#ffffff" />
            </svg>
            推荐中心
          </x-button>
        </flexbox-item>
      </flexbox>

      <flexbox :gutter="26">
        <flexbox-item>
          <x-button class="car-btn car-btn__blue car-btn--radius" link="/business/record">
            <svg class="svg-icon" width="22px" height="22px" viewBox="0 0 1024 1024">
              <path d="M512.213 531.36c91.499 0 165.692-110.062 165.692-197.164h-331.398c0 87.102 74.185 197.164 165.707 197.164z" fill="#ffffff" p-id="5385"></path><path d="M346.095 334.198h-331.398c0 87.102 74.185 197.164 165.708 197.164 91.499-0.001 165.691-110.063 165.691-197.164z" fill="#ffffff" p-id="5386"></path><path d="M843.612 531.36c91.499 0 165.691-110.062 165.691-197.164h-331.397c0 87.102 74.182 197.164 165.707 197.164z" fill="#ffffff" p-id="5387"></path><path d="M869.024 118.314c-56.378-55.826-101.6-59.909-137.367-59.909h-439.075c-59.466 0-89.061 11.917-137.539 59.909l-142.042 177.162h997.998l-141.974-177.162z" fill="#ffffff" p-id="5388"></path><path d="M847.628 768.693h-671.266v-157.521h-83.904v275.646c0 43.523 37.557 78.778 83.904 78.778h671.266c46.348 0 83.913-35.254 83.913-78.778v-275.646h-83.913v157.521z" fill="#ffffff" p-id="5389"></path>
            </svg>
            专员洗车
          </x-button>
        </flexbox-item>
        <flexbox-item>
          <x-button class="car-btn car-btn__yellow car-btn--radius" link="/pay/history">
            <svg class="svg-icon" width="22px" height="22px" viewBox="0 0 1024 1024">
              <path d="M810.972 156.808c-14.898-28.148-57.109-23.996-57.109-23.996h-486.054c0 0-42.211-4.151-57.11 23.996-14.898 28.147-116.703 289.681-116.703 289.681v379.070c0 0 14.278 41.591 70.147 41.591s67.662-41.591 67.662-41.591v-58.351h558.062v58.351c0 0 11.795 41.591 67.664 41.591 55.867 0 70.145-41.591 70.145-41.591v-379.070c0.001 0-101.803-261.533-116.703-289.681zM261.911 637.469c-39.254 0-71.078-31.814-71.078-71.077s31.823-71.078 71.078-71.078c39.253 0 71.078 31.814 71.078 71.078 0 39.263-31.824 71.077-71.078 71.077zM759.76 637.469c-39.254 0-71.077-31.814-71.077-71.077s31.823-71.078 71.077-71.078 71.077 31.814 71.077 71.078c0 39.263-31.823 71.077-71.078 71.077zM822.97 400.126c-13.24 0-292.582 0-292.582 0h-39.108c0 0-279.342 0-292.582 0-9.108 0-9.728-10.96-9.728-10.96s57.11-174.434 63.317-187.469c6.207-13.037 22.144-10.96 22.144-10.96h472.806c0 0 15.936-2.076 22.144 10.96 6.207 13.036 63.318 187.469 63.318 187.469s-0.621 10.96-9.728 10.96z" fill="#ffffff"></path>
            </svg>
            洗车记录
          </x-button>
        </flexbox-item>
      </flexbox>
    </div>

    <!-- 关注公众号弹窗 -->
    <div v-transfer-dom>
      <x-dialog
        class="person-index__dialog"
        v-model="active"
        hide-on-blur
      >
        <img src="../../assets/qrcode.jpg" style="max-width:100%">
        <p>长按识别二维码关注公众号</p>
      </x-dialog>
    </div>

  </div>
</template>

<script>
/**
 * 首页
 * @author zml
 * @version 2017-07-25
 */

import {
  Countup,
  XButton,
  XDialog,
  Flexbox,
  FlexboxItem,
  Icon,
  TransferDomDirective as TransferDom,
} from 'vux';

export default {

  name: 'app-person-index',

  directives: {
    TransferDom,
  },

  components: {
    Countup,
    XButton,
    XDialog,
    Flexbox,
    FlexboxItem,
    Icon,
  },

  data() {
    return {
      uname: '', // 用户名
      balance: 0, // 账户余额
      active: false, // 弹窗控制
    };
  },

  methods: {
    // 获取用户信息
    getMemberDetail() {
      this.$http.get('/mobileMember!getMemberDetail.do')
        .then((res) => {
          this.uname = res.uname;
          this.balance = res.balance;
        })
        .catch((error) => {
          this.$vux.toast.text(error, 'top');
        });
    },

    // 跳转支付链接
    goTo() {
      location.href = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx5b8c01540c879485&redirect_uri=http%3a%2f%2fapp.yunlinggroup.com%2fcxcar%2f%23%2fpay&response_type=code&scope=snsapi_base&state=123#wechat_redirect';
    },

    // 调起微信扫一扫接口
    scanQRCode() {
      console.log('调起微信扫一扫接口');
      this.$wechat.scanQRCode({
        needResult: 0, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，
        scanType: ['qrCode', 'barCode'], // 可以指定扫二维码还是一维码，默认二者都有
      });
    },

    // 打开二维码弹窗
    openDialog() {
      this.active = true;
    },
  },

  created() {
    this.getMemberDetail();
  },

};

</script>

<style lang="less">
  .person-index {
    position: relative;
    height: 100vh;
    background-image: url('../../assets/bg.png');
    background-size: 100% auto;
    background-position-y: -45px;
    background-repeat: no-repeat;
    background-color: rgb(49, 60, 80);

    &__btns {
      position: absolute;
      width: calc(~"100% - 30px");
      bottom: 5%;
      left: 15px;

      &__margin {
        margin-bottom: 20px
      }
    }

    &__text {
      position: absolute;
      width: 100%;
      text-align: center;
      color: #fff;
      font-size: 15px;
      line-height: 1;

      &__name {
        top: 75px;
      }

      &__price {
        font-family: 'Source Sans Pro', Helvetica, Arial, sans-serif;
        top: 130px;
        font-size: 50px;
      }

      &__tips {
        top: 190px;
      }

      &__transfer {
        top: 220px;

        .weui-btn {
          color: #fff;
          padding: 0 1em;

          & svg {
            margin-right:5px;
          }
        }
      }
    }

    &__dialog {
      line-height: 1;

      p {
        color: #999;
        font-size: 15px;
        padding-bottom: 20px;
      }
    }
  }

</style>
